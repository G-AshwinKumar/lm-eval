slurmstepd: info: Setting TMPDIR to /scratch/6058684. Previous errors about TMPDIR can be discarded
Starting sbatch script at Fri Mar  1 01:01:27 PM CET 2024 for Nous-Hermes-2-SOLAR-10.7B
Current directory: '/mnt/lustre/scratch/nlsas/home/res/cns10/SHARE/pipelines/lm-evaluation-harness/1e812c2b'
INFO 03-01 13:02:11 llm_engine.py:72] Initializing an LLM engine with config: model='/mnt/lustre/scratch/nlsas/home/res/cns10/SHARE/Models_Trained/llm/Nous-Hermes-2-SOLAR-10.7B', tokenizer='/mnt/lustre/scratch/nlsas/home/res/cns10/SHARE/Models_Trained/llm/Nous-Hermes-2-SOLAR-10.7B', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, seed=1234)
INFO 03-01 13:02:28 llm_engine.py:322] # GPU blocks: 840, # CPU blocks: 1365
INFO 03-01 13:02:33 model_runner.py:632] Capturing the model for CUDA graphs. This may lead to unexpected consequences if the model is not static. To run the model in eager mode, set 'enforce_eager=True' or use '--enforce-eager' in the CLI.
INFO 03-01 13:02:33 model_runner.py:636] CUDA graphs can take additional 1~3 GiB memory per GPU. If you are running out of memory, consider decreasing `gpu_memory_utilization` or enforcing eager mode. You can also reduce the `max_num_seqs` as needed to decrease memory usage.
INFO 03-01 13:02:38 model_runner.py:698] Graph capturing finished in 5 secs.
vllm (pretrained=/mnt/lustre/scratch/nlsas/home/res/cns10/SHARE/Models_Trained/llm/Nous-Hermes-2-SOLAR-10.7B,tensor_parallel_size=1,trust_remote_code=True,dtype=bfloat16,gpu_memory_utilization=0.6), gen_kwargs: (None), limit: None, num_fewshot: None, batch_size: 1
|             Tasks             |Version|Filter|n-shot| Metric |Value |   |Stderr|
|-------------------------------|-------|------|------|--------|-----:|---|-----:|
|stem                           |N/A    |none  |None  |acc_norm|0.5114|±  |0.0068|
|                               |       |none  |None  |acc     |0.5583|±  |0.0058|
| - medmcqa                     |Yaml   |none  |None  |acc     |0.4968|±  |0.0077|
|                               |       |none  |None  |acc_norm|0.4968|±  |0.0077|
| - medqa_4options              |Yaml   |none  |None  |acc     |0.5593|±  |0.0139|
|                               |       |none  |None  |acc_norm|0.5593|±  |0.0139|
| - anatomy (mmlu)              |      0|none  |None  |acc     |0.5926|±  |0.0424|
| - clinical_knowledge (mmlu)   |      0|none  |None  |acc     |0.7057|±  |0.0280|
| - college_biology (mmlu)      |      0|none  |None  |acc     |0.7708|±  |0.0351|
| - college_medicine (mmlu)     |      0|none  |None  |acc     |0.6532|±  |0.0363|
| - medical_genetics (mmlu)     |      0|none  |None  |acc     |0.7700|±  |0.0423|
| - professional_medicine (mmlu)|      0|none  |None  |acc     |0.7426|±  |0.0266|
| - pubmedqa                    |      1|none  |None  |acc     |0.7460|±  |0.0195|

|Groups|Version|Filter|n-shot| Metric |Value |   |Stderr|
|------|-------|------|------|--------|-----:|---|-----:|
|stem  |N/A    |none  |None  |acc_norm|0.5114|±  |0.0068|
|      |       |none  |None  |acc     |0.5583|±  |0.0058|

